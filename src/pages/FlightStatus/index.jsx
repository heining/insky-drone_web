// @ts-ignore
import { LineLayer, Scene, Scale, Zoom, Popup, Marker, MarkerLayer, PointLayer } from '@antv/l7';
import { GaodeMap, Mapbox } from '@antv/l7-maps';
import * as React from 'react';
import { RouteIcon } from '@/components/InskyIcon';
import { getDeviceData, getDeviceDataId } from './service';
import drone_ger5 from '../../assets/icons/drone_ger5.png'

const makerColors = ['red', 'orange', 'yellow', 'green', 'blue', 'purple']
const colors = {
  red5: '#ff4d4f',
  volcano5: '#ff7a45',
  orange6: '#fa8c16',
  gold6: '#faad14',
  yellow6: '#fadb14',
  lime6: '#a0d911',
  green4: '#95de64',
  cyan4: '#5cdbd3',
  blue4: '#69c0ff',
  geek6: '#2f54eb',
  purple4: '#b37feb',
  magenta4: '#ff85c0',
  gray6: '#bfbfbf'
}

export default class FlightStatus extends React.Component {

  componentWillUnmount() {
    this.scene.destroy();
    clearInterval(this.time)
  }

  async componentDidMount() {
    const map = new AMap.Map('map', {
      // viewMode: '3D',
      // pitch: 0,
      resizeEnable: true,
      zoom: 14
    })
    const scene = new Scene({
      id: 'map',
      map: new GaodeMap({
        mapInstance: map,
      }),
      logoVisible: false
    });
    this.scene = scene

    //创建自定义图标
    var icon = new AMap.Icon({
      image: require(`../../assets/icons/${'drone_ger5'}.png`),
      size: new AMap.Size(28, 28),
      imageSize: new AMap.Size(28, 28)
    });
    var marker = new AMap.Marker({
      position: new AMap.LngLat(121.561324, 31.231341),
      offset: new AMap.Pixel(-14, -14),
      icon: icon,
    });
    this.marker = marker
    let i = 0
    this.time = setInterval(() => {
      if (_points[i]) {
        this.marker.setPosition(_points[i])
        i++
        console.log(_points[i])
      } else {
        clearInterval(this.time)
      }
    }, 1000)
    var infoWindow = new AMap.InfoWindow({offset: new AMap.Pixel(0, -30)});
    marker.content = '我是第' + 1 + '个Marker';
    marker.on('click', ()=>{
      infoWindow.setContent(marker.content)
      infoWindow.open(map, marker.getPosition())
    });

    map.add(marker);

    //创建地图类型切换插件
    var type = new AMap.MapType({
      defaultType: 0 //使用2D地图
    });
    map.addControl(type);

    //
    var scale = new AMap.Scale({});
    map.addControl(scale);

    //监听鼠标位置经纬度
    // map.on('mousemove',e => {console.log(e)})

  }

  markerClick(e) {
    infoWindow.setContent(e.target.content);
    infoWindow.open(map, e.target.getPosition());
  }

  droneMove() {
    if (this.thing) {
      let i = 0
      let time = setInterval(() => {
        if (_points[i]) {
          this.marker.setPosition(_points[i])
          i++
          console.log(_points[i])
        } else {
          clearInterval(time)
        }
      }, 1000)
    }
  }

  render() {
    return (
      <div
        id="map"
        style={{
          position: 'absolute',
          top: 0,
          bottom: 0,
          width: '100%',
          height: '102%',
        }}
      />
    );
  }
}

const _points = [
  [121.56131744384767, 31.231298103688736],
  [121.56131744384767, 31.233646625044802],
  [121.56063079833983, 31.235114421248575],
  [121.55857086181639, 31.23687574659226],
  [121.55582427978514, 31.23804994524463],
  [121.5523910522461, 31.240104757766613],
  [121.55033111572266, 31.240985378021307],
  [121.5468978881836, 31.243040126686836],
  [121.54483795166014, 31.244801304249997],
  [121.54312133789062, 31.24656244897016],
  [121.54106140136719, 31.248323560846238],
  [121.53831481933595, 31.249497617183085],
  [121.53282165527342, 31.251258674316755],
  [121.53041839599611, 31.251258674316755],
  [121.52981758117676, 31.251332050984484],
  [121.52904510498045, 31.25184568606204],
  [121.52827262878417, 31.252285942475925],
  [121.52767181396483, 31.252799572364033],
  [121.52681350708008, 31.25331319945781],
  [121.52621269226074, 31.253533324499745],
  [121.52518272399904, 31.253533324499745],
  [121.52449607849123, 31.253606699399647],
  [121.52363777160643, 31.253680074242528],
  [121.52243614196776, 31.253900198429022],
  [121.52123451232912, 31.253900198429022],
  [121.52063369750977, 31.253900198429022],
  [121.5201187133789, 31.253900198429022],
  [121.51908874511717, 31.253459949542798],
  [121.5183162689209, 31.252799572364033],
  [121.51771545410155, 31.25235931834531],
  [121.51702880859374, 31.251698933467875],
  [121.51668548583984, 31.250818413112672],
  [121.51651382446288, 31.25008463987724],
  [121.51651382446288, 31.2493508609393],
  [121.51651382446288, 31.248543697521345],
  [121.51651382446288, 31.247369629323753],
  [121.51677131652832, 31.246635829287413],
  [121.51677131652832, 31.245681880715527],
  [121.51677131652832, 31.244654540707472],
  [121.5164279937744, 31.243920719573723],
  [121.5164279937744, 31.243113509741022],
  [121.51608467102051, 31.242159525589464],
  [121.51591300964354, 31.24135230070429],
  [121.51556968688965, 31.24069183884865],
  [121.51531219482423, 31.239957986925965],
  [121.51522636413573, 31.23944428718776],
  [121.51479721069336, 31.238783811990814],
  [121.51411056518555, 31.238416879330384],
  [121.51402473449707, 31.237462847742812],
  [121.51376724243163, 31.236362030092458],
  [121.51376724243163, 31.23562814453258],
  [121.5138530731201, 31.234967642654343],
  [121.51402473449707, 31.234233746262717],
  [121.51402473449707, 31.233353063067668],
  [121.51445388793944, 31.23269254528419],
  [121.51471138000488, 31.23173845588948],
  [121.51548385620117, 31.23012382112059],
  [121.51634216308594, 31.229683461395265],
  [121.51659965515138, 31.229243099617822],
  [121.51720046997069, 31.228582553103937],
  [121.51762962341309, 31.22814218619626],
  [121.51762962341309, 31.227628422210365],
  [121.51771545410155, 31.226967864410142],
  [121.51780128479002, 31.226307301992847],
  [121.51805877685547, 31.225646734958584],
  [121.51814460754395, 31.225499941657286],
  [121.51891708374023, 31.224619177061744],
  [121.51968955993651, 31.223738404258437],
  [121.52140617370605, 31.22322461633284],
  [121.52166366577147, 31.222490628737308],
  [121.52235031127928, 31.221756635442144],
  [121.52320861816408, 31.221242836744313],
  [121.52389526367188, 31.22094923623453],
  [121.52406692504883, 31.220362032479237],
  [121.52423858642578, 31.219701423894513],
  [121.52483940124512, 31.21867380136463],
  [121.52509689331053, 31.217866375826173],
  [121.52578353881835, 31.216765329887743],
  [121.52604103088379, 31.21625150406156],
  [121.52621269226074, 31.215737675442902],
  [121.52655601501465, 31.21537065329133],
  [121.52689933776854, 31.214489794314737],
  [121.52810096740723, 31.214049361749087],
  [121.52913093566896, 31.213829144696938],
  [121.53050422668457, 31.21375573889891],
  [121.53127670288086, 31.21375573889891],
  [121.5333366394043, 31.213682333043916],
  [121.53436660766603, 31.213829144696938],
  [121.53496742248534, 31.214049361749087],
  [121.53616905212401, 31.213975956122024],
  [121.53676986694335, 31.213975956122024],
  [121.53745651245116, 31.21390255043799],
  [121.53865814208984, 31.213535521162918],
  [121.53977394104004, 31.213462115136963],
  [121.541748046875, 31.21258123838038],
  [121.54269218444823, 31.21214079692485],
  [121.54329299926758, 31.21214079692485],
  [121.54397964477538, 31.21214079692485],
  [121.54475212097167, 31.21214079692485],
  [121.54569625854492, 31.212214203976572],
  [121.54655456542969, 31.212214203976572],
  [121.5475845336914, 31.212361017909032],
  [121.54878616333006, 31.21280145833882],
  [121.54955863952637, 31.21272805174301],
  [121.55118942260742, 31.212507831613586],
  [121.5519618988037, 31.212067389816134],
  [121.5523910522461, 31.21140672327351],
  [121.55316352844238, 31.210966276347424],
  [121.55367851257324, 31.2102321935786],
  [121.55496597290039, 31.210085376341038],
  [121.55573844909668, 31.210011967636778],
  [121.55633926391602, 31.210085376341038],
  [121.55694007873535, 31.210379010588234],
  [121.55728340148924, 31.210525827369935],
  [121.55771255493164, 31.210892868326983],
  [121.55857086181639, 31.2111130922174],
  [121.55882835388184, 31.211700353417864],
  [121.55942916870117, 31.212214203976572],
  [121.56011581420898, 31.21265464509018],
  [121.56063079833983, 31.213315302914065],
  [121.5608024597168, 31.21375573889891],
  [121.56131744384767, 31.214416389029594],
  [121.56131744384767, 31.215297248690035],
  [121.56251907348631, 31.215517462322936],
  [121.56320571899413, 31.215957888049985],
  [121.5644073486328, 31.21603129213837],
  [121.56543731689453, 31.216104696169765],
  [121.56620979309082, 31.216104696169765],
  [121.56715393066405, 31.21522384403177],
  [121.56732559204102, 31.213608927131904],
  [121.56732559204102, 31.212361017909032],
  [121.56732559204102, 31.21162694596725],
  [121.56732559204102, 31.210819460249517],
  [121.56732559204102, 31.20979174118209],
  [121.56749725341797, 31.208617191429184],
  [121.56732559204102, 31.207809680012264],
  [121.56732559204102, 31.206781928237312],
  [121.56741142272949, 31.205680753228233],
  [121.56749725341797, 31.205093454648008],
  [121.56749725341797, 31.204285913146016],
  [121.56775474548338, 31.20318470907827],
  [121.56758308410645, 31.20259739500032],
  [121.56758308410645, 31.20178983218925],
  [121.56758308410645, 31.200908846714693],
  [121.56766891479491, 31.200027853035934],
  [121.56766891479491, 31.19892659940056],
  [121.56766891479491, 31.198412676650566],
  [121.56766891479491, 31.197237985596526],
  [121.56766891479491, 31.196650634600406],
  [121.56784057617186, 31.195696181455425],
  [121.56784057617186, 31.195108820888557],
  [121.5680980682373, 31.1943746150529],
  [121.5680980682373, 31.193199873866835],
  [121.56826972961426, 31.19224538591511],
  [121.56826972961426, 31.191290888336383],
  [121.56826972961426, 31.190116108870125],
  [121.56826972961426, 31.18930843952816],
  [121.56826972961426, 31.188574188690865],
  [121.56861305236816, 31.187766506190865],
  [121.56998634338379, 31.187839932157498],
  [121.57084465026855, 31.18806020971558],
  [121.57161712646483, 31.188500763293852],
  [121.5721321105957, 31.188941314821538],
  [121.57376289367674, 31.189161589816393],
  [121.57530784606934, 31.1893818642986],
  [121.57676696777344, 31.189528713668594],
  [121.57779693603517, 31.18989583609677],
  [121.578311920166, 31.19004268466931],
  [121.57934188842773, 31.19063007668095],
  [121.58011436462402, 31.191290888336383],
  [121.58045768737793, 31.19187827260103],
  [121.58080101013184, 31.192612497805065],
  [121.58123016357422, 31.193493560530538],
  [121.58157348632811, 31.19452145667578],
  [121.58191680908203, 31.195769601269927],
  [121.58217430114745, 31.196356957735073],
  [121.58226013183592, 31.197017729400248],
  [121.58226013183592, 31.197898751108983],
  [121.58243179321289, 31.199660769915113],
  [121.58243179321289, 31.200541767012233],
  [121.58251762390137, 31.201569586589738],
  [121.58260345458984, 31.20281763820686],
  [121.58286094665526, 31.204506152421185],
  [121.58371925354005, 31.205974401150872],
  [121.58397674560547, 31.207736269541574],
  [121.58371925354005, 31.20869060121611],
  [121.58371925354005, 31.209498105111447],
  [121.58389091491699, 31.210966276347424],
  [121.58466339111328, 31.211847168148132],
  [121.58595085144043, 31.213388709053987],
  [121.58698081970216, 31.21434298368746],
  [121.58732414245605, 31.216104696169765],
  [121.58775329589844, 31.217572764829725],
  [121.58809661865233, 31.219774825076357],
  [121.5886116027832, 31.221683235799155],
  [121.58921241760254, 31.223151217829788],
  [121.58998489379883, 31.22483936898011],
  [121.59092903137208, 31.226013717214293],
  [121.59110069274902, 31.22740823678995],
  [121.59152984619139, 31.228068791512136],
  [121.59187316894531, 31.228729341617147],
  [121.59221649169923, 31.229243099617822],
  [121.59255981445312, 31.229756854825336],
  [121.59290313720705, 31.230710964228813],
  [121.59350395202635, 31.23159167205059],
  [121.59367561340332, 31.232472371663587],
  [121.59367561340332, 31.232986109313597],
  [121.59401893615721, 31.233940186109823],
  [121.5937614440918, 31.234527305503477],
  [121.5933322906494, 31.235554755663017],
  [121.5933322906494, 31.23643541833489],
  [121.59324645996094, 31.23687574659226],
  [121.59316062927246, 31.23715095071089],
  [121.59281730651854, 31.23727937902522]
]
